!function(t){function o(t){var e=this;e._state=0,e._executor=t,e._resolveList=[],e._onCatch=null}o.prototype.then=function(t){return this._resolveList.push(t),this},o.prototype.catch=function(t){return this._onCatch=t,this},o.prototype.destroy=function(){this._resolveList.length=0,this._onCatch=null},o.prototype.run=o.prototype.done=o.prototype.start=function(){var e=this,o=null,n=null,r=null;0===e._state&&(n=function(t){for(o=t;0<e._resolveList.length;){n=e._resolveList.shift();try{o=n(o)}catch(t){"function"==typeof(r=e._onCatch)&&r(t),e._state=2;break}}e.destroy(),0===e._state&&(e._state=1)},e._executor(n))},o.resolve=function(e){return new o(function(t){t(e)})},t.Waiter=o,"object"==typeof exports&&(exports.Waiter=o)}(this);